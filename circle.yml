general:
  branches:
    only:
      - circle_ci
      - production

machine:
  timezone:
    Etc/UTC
  services:
    - docker
  environment:
    RAILS_ENV: test
    RACK_ENV: test
    NEW_RELIC_LOG: stdout
    WEB_CONCURRENCY: 3
    CXX: g++-4.8

dependencies:
  pre:
    - sudo apt-get update
    - sudo apt-get install python3-setuptools python3-dev
    - sudo easy_install3 pip
    - sudo -H pip install awsebcli

deployment:
  hub:
    branch: circle_ci
    commands:
      - eb use ${EB_ENVIRONMENT}
      - eb deploy
